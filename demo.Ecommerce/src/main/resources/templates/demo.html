<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Demo Ecommerce</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="/css/demo.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />
</head>

<body>
<div class="app-container container-fluid">
    <div class="search-bar">
        <input type="search" class="search-input" placeholder="Buscar por ' Nombre ' " aria-label="Buscar"
               id="barra-busqueda" />
        <svg class="search-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
             stroke="currentColor" stroke-width="2" aria-hidden="true">
            <path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
        </svg>
    </div>

    <div class="filters-btns" role="group" aria-label="Opciones de filtros">
        <button type="button" aria-label="Listado" id="btn-filtrar" class="btn btn-sm">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor"
                 class="bi bi-filter-circle mx-1" viewBox="0 0 16 16">
                <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16" />
                <path
                        d="M7 11.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 0 1h-1a.5.5 0 0 1-.5-.5m-2-3a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5m-2-3a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5" />
            </svg>
            Filtrar
        </button>

        <button type="button" aria-label="Listado" class="btn btn-sm " id="btn-ordenar">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor"
                 class="bi bi-sort-down-alt mx-1" viewBox="0 0 16 16">
                <path
                        d="M3.5 3.5a.5.5 0 0 0-1 0v8.793l-1.146-1.147a.5.5 0 0 0-.708.708l2 1.999.007.007a.497.497 0 0 0 .7-.006l2-2a.5.5 0 0 0-.707-.708L3.5 12.293zm4 .5a.5.5 0 0 1 0-1h1a.5.5 0 0 1 0 1zm0 3a.5.5 0 0 1 0-1h3a.5.5 0 0 1 0 1zm0 3a.5.5 0 0 1 0-1h5a.5.5 0 0 1 0 1zM7 12.5a.5.5 0 0 0 .5.5h7a.5.5 0 0 0 0-1h-7a.5.5 0 0 0-.5.5" />
            </svg>
            Ordenar
        </button>
    </div>

    <div class="banner d-flex align-items-center" role="region" aria-label="Banner promocional">
        <div class="banner-content">Descuentos por<br>Fin de Mes</div>
        <img src="/images/logo_magnolias.jpeg" alt="Logo_Magnolias" class="banner-image"/>
    </div>

    <!-- Contenido modificado con carruseles de Bootstrap -->

    <!-- Categorías con carrusel -->
    <div class="section-title d-flex justify-content-between align-items-center" tabindex="0"
         aria-label="Sección título con flecha" style="cursor:pointer;" data-bs-toggle="collapse"
         data-bs-target="#Categories" aria-expanded="true">
        <span class="fs-2">Categorías</span>
        <svg xmlns="http://www.w3.org/2000/svg" width="70" height="70" fill="currentColor"
             class="bi bi-arrow-down-circle" viewBox="0 0 16 16">
            <path fill-rule="evenodd"
                  d="M1 8a7 7 0 1 0 14 0A7 7 0 0 0 1 8m15 0A8 8 0 1 1 0 8a8 8 0 0 1 16 0M8.5 4.5a.5.5 0 0 0-1 0v5.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293z" />
        </svg>
    </div>

    <div id="Categories" class="collapse show">
        <div th:if="${#lists.isEmpty(categorias_lista)}">
            <u>
                <p class="text-center m-5 fw-bold fst-italic fs-4">No hay categorías disponibles...</p>
            </u>
        </div>
        <div class="d-flex justify-content-evenly gap-3 px-2">
            <!-- Iteramos sobre la lista de categorías -->
            <div class="category mx-auto" style="min-width : 100px;" th:each="cat : ${categorias_lista}">

                <a th:href="@{'/api/demo/productos/filter/categoria/' + ${cat.categoria}}"
                   style="text-decoration : none;">
                    <!-- Ruta de imagen dinámica -->
                    <img class="rounded-circle shadow-sm" th:src="@{${cat.url_imagen}}" th:alt="${cat.categoria}" />

                    <!-- Nombre dinámico -->
                    <div class="category-label mt-1 fw-bold fs-5" th:text="${cat.categoria}">
                        Nombre de categoría
                    </div>
                </a>
            </div>
        </div>
    </div>

    <br>
    <hr> <br>

    <div class="main-products">
        <div class="section-title d-flex justify-content-between align-items-center" tabindex="0"
             aria-label="Sección título con flecha" style="cursor:pointer;" data-bs-toggle="collapse"
             data-bs-target="#Products" aria-expanded="true">
            <span class="fs-2">Productos</span>
            <svg xmlns="http://www.w3.org/2000/svg" width="50" height="50" fill="currentColor"
                 class="bi bi-arrow-down-circle" viewBox="0 0 16 16">
                <path fill-rule="evenodd"
                      d="M1 8a7 7 0 1 0 14 0A7 7 0 0 0 1 8m15 0A8 8 0 1 1 0 8a8 8 0 0 1 16 0M8.5 4.5a.5.5 0 0 0-1 0v5.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293z" />
            </svg>
        </div>
        <div id="Products" class="collapse show">
            <div th:if="${#lists.isEmpty(productos_lista)}">
                <u>
                    <p class="text-center m-5 fw-bold fst-italic fs-4">No hay productos disponibles...</p>
                </u>
            </div>
            <div class="row">
                <div class="col-md-4 mx-auto my-3 item-layout" th:each="producto : ${productos_lista}">

                    <div class="card" style="min-width : 476px; min-height : 600px;">
                        <div class="img-product-container mx-auto m-3" style="max-width : 300px;">
                            <img th:src="@{${producto.url_imagen}}" class="card-img-top rounded-4"
                                 style="min-width : 300px; min-height : 300px;" alt="producto" />
                        </div>
                        <div class="card-body">
                            <h3 class="card-title my-2 fst-italic fw-bold text-center" th:text="${producto.nombre}">
                                Nombre Producto
                            </h3>
                        </div>

                        <ul class="list-group list-group-flush">
                            <li class="list-group-item my-2 fw-bold" th:text="'Marca: ' + ${producto.marca}">
                                Marca
                            </li>
                            <li class="list-group-item my-2 fw-bold"
                                th:text="'Categoría: ' + ${producto.categoria.categoria}">
                                Categoria
                            </li>
                            <li class="list-group-item my-2" th:text="'Descripción: ' + ${producto.descripcion}">
                                Descripción:
                            </li>
                            <li class="list-group-item my-2 text-center" th:text="'Precio: $' + ${producto.precio}">
                                Precio: $10.00
                            </li>
                        </ul>
                        <div th:if="${producto.porcentajeDescuento != null and producto.porcentajeDescuento > 0}"
                             class="alert alert-success text-center">
                            ¡ Este producto tiene un descuento del <strong
                                th:text="${producto.porcentajeDescuento} + '% '"></strong> !
                        </div>

                        <div class="card-body d-flex justify-content-evenly">
                            <button class="btn btn-primary btn-detalles" th:attr="
                                                data-id=${producto.id},
                                                data-nombre=${producto.nombre},
                                                data-categoria=${producto.categoria.categoria},
                                                data-url=${producto.url_imagen},
                                                data-marca=${producto.marca},
                                                data-descripcion=${producto.descripcion},
                                                data-precio=${producto.precio},
                                                data-cantidad=${producto.cantidad}
                                              ">
                                Detalles
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor"
                                     class="bi bi-info-circle-fill  mb-1 ms-1" viewBox="0 0 16 16">
                                    <path
                                            d="M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16m.93-9.412-1 4.705c-.07.34.029.533.304.533.194 0 .487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703 0-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381 2.29-.287zM8 5.5a1 1 0 1 1 0-2 1 1 0 0 1 0 2" />
                                </svg>
                            </button>
                            <button class="btn btn-primary btn-agregar-favoritos">
                                Agregar a Favoritos
                                <svg xmlns="http://www.w3.org/2000/svg" width="21" height="21" fill="currentColor"
                                     class="bi bi-star-fill mb-1 ms-1" viewBox="0 0 16 16">
                                    <path
                                            d="M3.612 15.443c-.386.198-.824-.149-.746-.592l.83-4.73L.173 6.765c-.329-.314-.158-.888.283-.95l4.898-.696L7.538.792c.197-.39.73-.39.927 0l2.184 4.327 4.898.696c.441.062.612.636.282.95l-3.522 3.356.83 4.73c.078.443-.36.79-.746.592L8 13.187l-4.389 2.256z" />
                                </svg>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <footer class="container-fluid">
        <nav class="footer-nav" role="navigation" aria-label="Navegación inferior">
            <button class="active" aria-label="Inicio">
                <a th:href="@{/api/demo/productos/all}">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24"
                         aria-hidden="true">
                        <path d="M3 9.5l9-7 9 7V20a2 2 0 0 1-2 2h-4v-6H9v6H5a2 2 0 0 1-2-2z" />
                    </svg>
                </a>
                Inicio
            </button>

            <button aria-label="Perfil">
                <a th:href="@{/api/demo/productos/login}">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24"
                         aria-hidden="true">
                        <circle cx="12" cy="7" r="4" />
                        <path d="M5.5 21a6.5 6.5 0 0 1 13 0" />
                    </svg>
                </a>
                Perfil
            </button>
        </nav>
    </footer>

    <!-- Modal genérico -->
    <div class="modal fade" id="modalProductoJS" data-bs-backdrop="static" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">

                <div class="modal-header">
                    <h5 class="modal-title" id="modalProductoJSTitle">Título</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
                </div>

                <div class="modal-body">
                    <div><strong>Categoría:</strong> <span id="modalProductoJSCategoria"></span></div>
                    <hr>
                    <div class="text-center my-3">
                        <img id="modalProductoJSImg" src="" alt="Imagen producto"
                             style="max-width:470px; max-height:240px;" class="rounded-5">
                    </div>
                    <hr>
                    <table class="table table-bordered">
                        <thead>
                        <tr>
                            <th>Marca</th>
                            <th>Descripción</th>
                            <th>Precio</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr>
                            <td id="modalProductoJSMarca"></td>
                            <td id="modalProductoJSDescripcion"></td>
                            <td id="modalProductoJSPrecio"></td>
                        </tr>
                        </tbody>
                    </table>
                    <div class="mt-5">
                        <strong class="my-2">Stock Disponible: <span id="modalProductoJSCantidad"></span></strong>
                    </div>
                </div>

                <div class="modal-footer justify-content-evenly">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                    <button type="button" class="btn btn-success modalProductoJSAgregarCarrito">
                        Agregar al Carrito
                        <svg xmlns="http://www.w3.org/2000/svg" width="21" height="21" fill="currentColor"
                             class="bi bi-cart-plus mb-1" viewBox="0 0 16 16">
                            <path
                                    d="M9 5.5a.5.5 0 0 0-1 0V7H6.5a.5.5 0 0 0 0 1H8v1.5a.5.5 0 0 0 1 0V8h1.5a.5.5 0 0 0 0-1H9z" />
                            <path
                                    d="M.5 1a.5.5 0 0 0 0 1h1.11l.401 1.607 1.498 7.985A.5.5 0 0 0 4 12h1a2 2 0 1 0 0 4 2 2 0 0 0 0-4h7a2 2 0 1 0 0 4 2 2 0 0 0 0-4h1a.5.5 0 0 0 .491-.408l1.5-8A.5.5 0 0 0 14.5 3H2.89l-.405-1.621A.5.5 0 0 0 2 1zm3.915 10L3.102 4h10.796l-1.313 7zM6 14a1 1 0 1 1-2 0 1 1 0 0 1 2 0m7 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0" />
                        </svg>
                    </button>
                </div>

            </div>
        </div>
    </div>


</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script src="/js/demo.js"></script>


<script>
    document.addEventListener('DOMContentLoaded', () => {
        // Inicializa el modal de Bootstrap
        const modalEl = document.getElementById('modalProductoJS');
        const bsModal = new bootstrap.Modal(modalEl);

        // Para cada botón de detalles…
        document.querySelectorAll('.btn-detalles').forEach(btn => {
            btn.addEventListener('click', () => {
                // Lee los atributos data-*
                const {
                    id, nombre, categoria,
                    url, marca, descripcion, precio, cantidad
                } = btn.dataset;

                // Inyecta en el modal
                modalEl.querySelector('#modalProductoJSTitle').textContent = nombre;
                modalEl.querySelector('#modalProductoJSCategoria').textContent = categoria;
                modalEl.querySelector('#modalProductoJSImg').src = url;
                modalEl.querySelector('#modalProductoJSMarca').textContent = marca;
                modalEl.querySelector('#modalProductoJSDescripcion').textContent = descripcion;
                // Formato de precio en MXN
                modalEl.querySelector('#modalProductoJSPrecio').textContent =
                    parseFloat(precio)
                        .toLocaleString('es-MX', { style: 'currency', currency: 'MXN' });
                modalEl.querySelector('#modalProductoJSCantidad').textContent = cantidad;

                bsModal.show();
            });
        });
    });
</script>
</body>

</html>